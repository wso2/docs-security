---
title: "CVE-2026-21884"
category: security-announcements
date: January 21, 2026
---

# CVE-2026-21884

<p class="doc-info">WSO2 Products Impacted: no</p>
<p class="doc-info">Customers Actions Required: no</p>
---

### REPORTED VULNERABILITY

A XSS vulnerability exists in React Router's "<ScrollRestoration>" API in Framework Mode when using the "getKey/storageKey" props during Server-Side Rendering which could allow arbitrary JavaScript execution during SSR if untrusted content is used to generate the keys. Note: This does not impact applications if developers have disabled server-side rendering in Framework Mode, or if they are using Declarative Mode (<BrowserRouter>) or Data Mode (createBrowserRouter/<RouterProvider>)[^1].

### REPORTED PRODUCTS

- WSO2 API Manager : 3.2.0, 3.2.1, 4.0.0, 4.1.0, 4.2.0, 4.3.0, 4.4.0, 4.5.0, 4.6.0

### WSO2 JUSTIFICATION

- WSO2 API Manager portals (Publisher, DevPortal, and Admin) are implemented as **client-side rendered applications** and do not use Server-Side Rendering (SSR). Therefore, the affected <ScrollRestoration> API and its associated `getKey` / `storageKey` behavior are not applicable, and the vulnerability cannot be triggered in API Manager portals.
  
- The security fix for this issue is available only in React Router version 7.12.0 and later, whereas WSO2 API Manager portals currently use React Router 5.3.4 version. Upgrading from v5 to v7 is a multi-major version migration upgrade and can’t be done as a simple dependency bump. According to the official documentation, upgrading from v5 to v6 requires significant refactoring of routing code[^2].

- Additionally v7 migration then adds further structural changes[^3](e.g., consolidating react-router-dom into react-router and adjusting DOM-specific imports) and requires completing a prior migration to v6 with specific “future flags” before proceeding to v7. This results in considerable code changes and multiple rounds of regression testing, with a higher chance of impacting critical portal behaviors such as authentication flows, navigation, and routing.
  
- Also, React Router 7.x requires React 18 as a prerequisite, and WSO2 API Manager supports React 18 only from version 4.3.0 onwards.
  
- Given that the vulnerability is not exploitable in the current client-side rendered architecture, fixing it would require a high-risk multi-major upgrade with significant engineering and testing effort.

### CONCLUSION

- Given that WSO2 API Manager portals operate using **client-side rendering** and the reported XSS vulnerability cannot be exploited. Therefore, **CVE-2026-21884 does not apply** to WSO2 API Manager.

### REFERENCES

[^1] : [https://nvd.nist.gov/vuln/detail/CVE-2026-21884](https://nvd.nist.gov/vuln/detail/CVE-2026-21884)
[^2] : [https://reactrouter.com/6.30.3/upgrading/v5#upgrade-all-switch-elements-to-routes](https://reactrouter.com/6.30.3/upgrading/v5#upgrade-all-switch-elements-to-routes)
[^3] : [https://reactrouter.com/upgrading/v6?utm_source=chatgpt.com#upgrade-to-v7](https://reactrouter.com/upgrading/v6?utm_source=chatgpt.com#upgrade-to-v7)
